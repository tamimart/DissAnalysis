offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 900, width = 1200)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.5,
cex.main = 1.5
)
dev.off()
png("Fig/funil_rato.png", height = 600, width = 900)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 1200, width = 1800)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 400, width = 600)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 600, width = 900)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 800, width = 1000)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_esp.png", height = 900, width = 1200)
png("Fig/funil_rato.png", height = 600, width = 800)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 400, width = 600)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2,
cex.axis = 2,
cex.main = 2
)
dev.off()
png("Fig/funil_rato.png", height = 400, width = 600)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.5,
cex.main = 1.5
)
dev.off()
png("Fig/funil_rato.png", height = 400, width = 600)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Ratos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#5fa7b2", "#37919f"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.3,
cex.main = 1.5
)
dev.off()
png("Fig/funil_camundongo.png", height = 400, width = 600)
funil_esp1_r <- metafor::funnel(
faltantes_m,
yaxis = "sei",
addtau2 = FALSE,
main = "Camundongos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ff7979", "#Ff5757"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.3,
cex.main = 1.5
)
dev.off()
png("Fig/funil_camundongo.png", height = 400, width = 600)
funil_esp1_m <- metafor::funnel(
faltantes_m,
yaxis = "sei",
addtau2 = FALSE,
main = "Camundongos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ff7979", "#Ff5757"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.3,
cex.main = 1.5
)
dev.off()
faltantes_m <- metafor::trimfill(Teste_mice, side = "left", estimator = "R0", maxiter = 100, verbose = FALSE) #R0 preferivel quando a MA tem >k Rothstein HR, Sutton AJ, Borenstein M. Publication Bias in Meta-Analysis: Prevention, Assessment and Adjustments. Chichester, UK: John Wiley & Sons; 2005. An advantage of estimator "R0" is that it provides a test of the null hypothesis that the number of missing studies (on the chosen side) is zero
Teste_mice <- rma(yi, vi, subset = (species == "mice"), data = Efeito)
faltantes_m <- metafor::trimfill(Teste_mice, side = "left", estimator = "R0", maxiter = 100, verbose = FALSE) #R0 preferivel quando a MA tem >k Rothstein HR, Sutton AJ, Borenstein M. Publication Bias in Meta-Analysis: Prevention, Assessment and Adjustments. Chichester, UK: John Wiley & Sons; 2005. An advantage of estimator "R0" is that it provides a test of the null hypothesis that the number of missing studies (on the chosen side) is zero
png("Fig/funil_camundongo.png", height = 400, width = 600)
funil_esp1_m <- metafor::funnel(
faltantes_m,
yaxis = "sei",
addtau2 = FALSE,
main = "Camundongos",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ff7979", "#Ff5757"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 1.5,
cex.axis = 1.3,
cex.main = 1.5
)
dev.off()
library(tidyverse) # manipulacao de dados
library(bitops)    # operadores
library(metafor)   # pacota para rodar meta-análise
library(Formula)
library(readxl)    # ler arquivo do excel
library(writexl)   # salvar excel
library(extrafont) # fonte extra
library(cowplot)   # alinhamento e anotacao plot
library(metapower) # calculo de poder
library(esc)       # calcular tamano de efeito
library(lubridate) # manipular datas
library(weightr)   # testar vies de publicação
library("devtools")# para baixar pacote remoto
library(patchwork) # para juntar plot
#devtools::install_github("dsquintana/metameta")
#library(metameta) # para calcular poder dos estudos incluidos
df <- read_excel("data/Data_200FST.xlsx") # Carregar planilha
# Mudar tipo da data para fator
df <- df %>%
mutate(year = as.numeric(format(as.Date(df$year, format = "%d/%m/%Y"),"%Y")))
glimpse(df)
# Separa metodo do detalhe do metodo (FST)
mmd <- df %>% # separar variavel em duas
select(measurement_method) %>%
separate(col = measurement_method, sep = ", ", into = c("measurement_method", "measurement_method_detail"))
df <- df %>%
mutate(measurement_method_detail = as.factor(mmd$measurement_method_detail),
measurement_method =  as.factor(mmd$measurement_method)) # adicionar variaveis separadas no df mãe
# criar funcao para converter hedges g para cohens d
g_to_d <- function(vg, vn) {
vd <- vg / (1 - 3 / (4 * (vn) - 9))
return(vd)
}
# Calcular tamanho de efeito em SDM hedges g
Efeito <- escalc(measure = "SMD", n1i = ctr_n_corr, n2i = atd_n_round, m1i = ctr_mean, m2i = atd_mean,
sd1i = ctr_sd, sd2i = atd_sd, data = df,
append = TRUE)
# Metaanalise por modelo de efeitos aleatorios --------------------------
Teste <- rma(yi, vi, data = Efeito, slab = (paste(Efeito$first_author, as.character(Efeito$year), sep = ", ")))
Teste_mice <- rma(yi, vi, subset = (species == "mice"), data = Efeito)
regtest(Teste_mice, model = "rma", predictor = "sei")
regtest(Teste_mice, model = "rma", predictor = "sqrtninv")
Teste_rat <- rma(yi, vi, subset = (species == "rat"), data = Efeito)
regtest(Teste_rat, model = "rma", predictor = "sei")
regtest(Teste_rat, model = "rma", predictor = "sqrtninv")
# [trim and fill]
faltantes_m <- metafor::trimfill(Teste_mice, side = "left", estimator = "R0", maxiter = 100, verbose = FALSE) #R0 preferivel quando a MA tem >k Rothstein HR, Sutton AJ, Borenstein M. Publication Bias in Meta-Analysis: Prevention, Assessment and Adjustments. Chichester, UK: John Wiley & Sons; 2005. An advantage of estimator "R0" is that it provides a test of the null hypothesis that the number of missing studies (on the chosen side) is zero
faltantes_r <- metafor::trimfill(Teste_rat, side = "left", estimator = "R0", maxiter = 100, verbose = FALSE) #R0 preferivel quando a MA tem >k Rothstein HR, Sutton AJ, Borenstein M. Publication Bias in Meta-Analysis: Prevention, Assessment and Adjustments. Chichester, UK: John Wiley & Sons; 2005. An advantage of estimator "R0" is that it provides a test of the null hypothesis that the number of missing studies (on the chosen side) is zero
faltantes_m
faltantes_r
png("Fig/funil_esp.png", height = 900, width = 1200)
par(mfrow = c(2, 2), oma = c(0,1,0,0), mar = c(5,5,5,1))
funil_esp1_m <- metafor::funnel(
faltantes_m,
yaxis = "sei",
addtau2 = FALSE,
main = "Camundongo",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ff9400", "#FE7700"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2.8,
cex.axis = 2.5,
cex.main = 2.2
)
funil_esp1_r <- metafor::funnel(
faltantes_r,
yaxis = "sei",
addtau2 = FALSE,
main = "Rato",
xlab = "Tamanho de efeito",
ylab = "Erro padrão",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ec2b2b", "#a6243a"),
hlines = "white",
xlim = c(-60,60),
ylim = c(13,0),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2.8,
cex.axis = 2.5,
cex.main = 2.2
)
funil_esp2_m <- metafor::funnel(
faltantes_m,
yaxis = "sqrtninv",
addtau2 = FALSE,
xlab = "Tamanho de efeito",
ylab = "1/√n",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#ff9400", "#FE7700"),
hlines = "white",
xlim = c(-60,60),
ylim = c(0.400,0.100),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2.8,
cex.axis = 2.5
)
funil_esp2_r <- metafor::funnel(
faltantes_r,
yaxis = "sqrtninv",
addtau2 = FALSE,
xlab = "Tamanho de efeito",
ylab = "1/√n",
back = "gray94",
level = c(90, 95, 99),
shade = c("white", "#a6243a", "#ec2b2b"),
hlines = "white",
xlim = c(-60,60),
ylim = c(0.400,0.100),
lty = 2,
pch = 19,
pch.fill = 1,
col = 25,
label = "F",
offset = 0.1,
legend = "topright",
ci.res = 1000,
cex.lab = 2.8,
cex.axis = 2.5
)
dev.off()
